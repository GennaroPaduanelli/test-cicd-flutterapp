"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5066],{5066:(w,u,l)=>{l.r(u),l.d(u,{FertilizzantiPageModule:()=>L});var F=l(6895),s=l(433),d=l(603),p=l(7486),t=l(4650),P=l(1364),m=l(5593),g=l(1493),b=l(805),h=l(5702),C=l(5047),_=l(1383),c=l(403),f=l(1740);const Z=["dt"];function T(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.apriModale())}),t.qZA(),t._uU(1,"\xa0 "),t._UZ(2,"button",14),t._uU(3,"\xa0 "),t._UZ(4,"button",15),t._uU(5,"\xa0 "),t.TgZ(6,"span",16),t._UZ(7,"i",17),t.TgZ(8,"input",18),t.NdJ("input",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.applyFilterGlobal(n,"contains"))}),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(4),t.Q6J("disabled",!e.fertilizzanti.length)}}function A(a,r){1&a&&(t.TgZ(0,"tr")(1,"th",19),t._uU(2,"NomeFertilizzante"),t._UZ(3,"p-sortIcon",20),t.qZA(),t.TgZ(4,"th",21),t._uU(5,"NumeroPassate "),t._UZ(6,"p-sortIcon",22),t.qZA(),t.TgZ(7,"th",21),t._uU(8,"Quantit\xe0KgEttaro"),t._UZ(9,"p-sortIcon",22),t.qZA(),t.TgZ(10,"th",21),t._uU(11,"PercentualeAzoto"),t._UZ(12,"p-sortIcon",22),t.qZA(),t.TgZ(13,"th",21),t._uU(14,"Co2Ettaro"),t._UZ(15,"p-sortIcon",22),t.qZA(),t.TgZ(16,"th",21),t._uU(17,"M3BlueWaterEttaro"),t._UZ(18,"p-sortIcon",22),t.qZA(),t._UZ(19,"th"),t.qZA())}function v(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"tr")(1,"td",23),t._uU(2),t.qZA(),t.TgZ(3,"td",23),t._uU(4),t.qZA(),t.TgZ(5,"td",23),t._uU(6),t.qZA(),t.TgZ(7,"td",23),t._uU(8),t.qZA(),t.TgZ(9,"td",23),t._uU(10),t.qZA(),t.TgZ(11,"td",23),t._uU(12),t.qZA(),t.TgZ(13,"td")(14,"button",24),t.NdJ("click",function(){const o=t.CHM(e).$implicit,z=t.oxw();return t.KtG(z.aggiornaFertilizzante(o))}),t.qZA(),t.TgZ(15,"button",25),t.NdJ("click",function(){const o=t.CHM(e).$implicit,z=t.oxw();return t.KtG(z.eliminaFertilizzante(o))}),t.qZA()()()}if(2&a){const e=r.$implicit;t.xp6(2),t.Oqu(e.nomeFertilizzante),t.xp6(2),t.Oqu(e.numeroPassate),t.xp6(2),t.Oqu(e.quantitaKgEttaro),t.xp6(2),t.Oqu(e.percentualeAzoto),t.xp6(2),t.Oqu(e.co2Ettaro),t.xp6(2),t.Oqu(e.m3BlueWaterEttaro)}}function M(a,r){if(1&a&&(t.TgZ(0,"div",26),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij(" In totale ci sono ",e.fertilizzanti?e.fertilizzanti.length:0," fertilizzanti. ")}}function x(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"div",27)(1,"label",28),t._uU(2,"Nome Fertilizzante"),t.qZA(),t.TgZ(3,"p-dropdown",29),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.selectedTipoFertilizzante=n)}),t.qZA()(),t._UZ(4,"br")(5,"br"),t.TgZ(6,"div",27)(7,"label",30),t._uU(8,"Numero Passate"),t.qZA(),t.TgZ(9,"p-inputNumber",31),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.selectedNumeroPassate=n)}),t.qZA()(),t._UZ(10,"br"),t.TgZ(11,"div",27)(12,"label",30),t._uU(13,"Quantit\xe0 KgEttaro"),t.qZA(),t.TgZ(14,"p-inputNumber",31),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.selecteQuantitaKgEttaro=n)}),t.qZA()(),t._UZ(15,"br"),t.TgZ(16,"div",27)(17,"label",30),t._uU(18,"PercentualeAzoto"),t.qZA(),t.TgZ(19,"p-inputNumber",31),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.selectedPercentualeAzoto=n)}),t.qZA()(),t._UZ(20,"br")}if(2&a){const e=t.oxw();t.xp6(3),t.Q6J("disabled",e.updating)("options",e.tipiFertilizzante)("ngModel",e.selectedTipoFertilizzante),t.xp6(6),t.Q6J("ngModel",e.selectedNumeroPassate)("showButtons",!0)("min",1)("required",!0),t.xp6(5),t.Q6J("ngModel",e.selecteQuantitaKgEttaro)("showButtons",!0)("min",1)("required",!0),t.xp6(5),t.Q6J("ngModel",e.selectedPercentualeAzoto)("showButtons",!0)("min",.1)("required",!0)}}function E(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.chiudiDialogFertilizzante())}),t.qZA(),t.TgZ(1,"button",33),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.salvaFertilizzante())}),t.qZA()}}const U=function(){return["operazione","co2Ettaro","numeroPassate"]},N=function(){return{width:"450px"}},q=[{path:"",component:(()=>{class a{constructor(e){this.misurazioneService=e,this.fertilizzanti=[],this.fertilizzantiSelezionati=[],this.dialogFertilizzantiVisible=!1,this.tipiFertilizzante=[],this.tipiFertilizzanteCheck=[],this.updating=!1,this.tipiFertilizzante=[{name:"NitratoDiAmmonio",code:"NitratoDiAmmonio",co2Ettaro:201.26,operandiCalcoloCo2:{n1:26.1,n2:2.49,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.07}},{name:"Urea",code:"Urea",co2Ettaro:126.084,operandiCalcoloCo2:{n1:26.1,n2:.611,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.121}},{name:"SolfatoDiAmmonio",code:"SolfatoDiAmmonio",co2Ettaro:86.69,operandiCalcoloCo2:{n1:26.1,n2:2.49,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.04}},{name:"CalcioAmmonioNitrato",code:"CalcioAmmonioNitrato",co2Ettaro:294.07,operandiCalcoloCo2:{n1:26.1,n2:.586,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.05}},{name:"LiquameBovino",code:"LiquameBovino",co2Ettaro:62.676,operandiCalcoloCo2:{n1:26.1,n2:1.89,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.04}},{name:"LetameBovino",code:"LetameBovino",co2Ettaro:70.076,operandiCalcoloCo2:{n1:26.1,n2:.033,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.09}},{name:"PollinaFresca",code:"PollinaFresca",co2Ettaro:260.41,operandiCalcoloCo2:{n1:26.1,n2:.0404,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.19}},{name:"PollinaEssiccata",code:"PollinaEssiccata",co2Ettaro:654.872,operandiCalcoloCo2:{n1:26.1,n2:.565,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:1.61}},{name:"LetameSuinoLiquido",code:"LetameSuinoLiquido",co2Ettaro:61.356,operandiCalcoloCo2:{n1:26.1,n2:.0287,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.03}},{name:"Compost",code:"Compost",co2Ettaro:175.96,operandiCalcoloCo2:{n1:26.1,n2:.129,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.19}}],this.tipiFertilizzanteCheck=[{name:"NitratoDiAmmonio",code:"NitratoDiAmmonio",co2Ettaro:201.26,operandiCalcoloCo2:{n1:26.1,n2:2.49,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.07}},{name:"Urea",code:"Urea",co2Ettaro:126.084,operandiCalcoloCo2:{n1:26.1,n2:.611,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.121}},{name:"SolfatoDiAmmonio",code:"SolfatoDiAmmonio",co2Ettaro:86.69,operandiCalcoloCo2:{n1:26.1,n2:2.49,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.04}},{name:"CalcioAmmonioNitrato",code:"CalcioAmmonioNitrato",co2Ettaro:294.07,operandiCalcoloCo2:{n1:26.1,n2:.586,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.05}},{name:"LiquameBovino",code:"LiquameBovino",co2Ettaro:62.676,operandiCalcoloCo2:{n1:26.1,n2:1.89,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.04}},{name:"LetameBovino",code:"LetameBovino",co2Ettaro:70.076,operandiCalcoloCo2:{n1:26.1,n2:.033,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.09}},{name:"PollinaFresca",code:"PollinaFresca",co2Ettaro:260.41,operandiCalcoloCo2:{n1:26.1,n2:.0404,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.19}},{name:"PollinaEssiccata",code:"PollinaEssiccata",co2Ettaro:654.872,operandiCalcoloCo2:{n1:26.1,n2:.565,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:1.61}},{name:"LetameSuinoLiquido",code:"LetameSuinoLiquido",co2Ettaro:61.356,operandiCalcoloCo2:{n1:26.1,n2:.0287,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.03}},{name:"Compost",code:"Compost",co2Ettaro:175.96,operandiCalcoloCo2:{n1:26.1,n2:.129,n3:.01,n4:298},operandiCalcoloWater:{n1:66.09,n2:.19}}],this.tipiFertilizzante.sort((i,n)=>i.name.localeCompare(n.name)),this.misurazione=e.getMisurazioneLocalStorage(),this.misurazione&&(null==this.misurazione.inputMisurazione.operazioniColturali.fertilizzanti?(this.misurazione.inputMisurazione.operazioniColturali.fertilizzanti=[],this.misurazione.dataOraUltimoAggiornamento=(new Date).toUTCString(),this.misurazioneService.updateMisurazione(this.misurazione.nomeMisurazione,this.misurazione),this.misurazioneService.salvaMisurazioneLocalStorage(this.misurazione)):(this.fertilizzanti=this.misurazione.inputMisurazione.operazioniColturali.fertilizzanti,this.tipiFertilizzante=this.tipiFertilizzante.filter(i=>!this.fertilizzanti.map(n=>n.nomeFertilizzante).includes(i.name))))}applyFilterGlobal(e,i){this.dt.filterGlobal(e.target.value,i)}apriModale(){this.updating=!1,this.tipiFertilizzante.length>0&&(this.dialogFertilizzantiVisible=!0),this.selectedNumeroPassate=1,this.selecteQuantitaKgEttaro=void 0,this.selectedPercentualeAzoto=void 0,this.selectedPercentualePrincipioAttivo=void 0}aggiornaFertilizzante(e){this.updating=!0,this.dialogFertilizzantiVisible=!0,this.selectedNumeroPassate=e.numeroPassate,this.selecteQuantitaKgEttaro=e.quantitaKgEttaro,this.selectedPercentualeAzoto=e.percentualeAzoto,this.selectedTipoFertilizzante={name:e.nomeFertilizzante,code:e.nomeFertilizzante,co2Ettaro:parseFloat(e.co2Ettaro)/e.numeroPassate},this.tipiFertilizzante.find(i=>i.name==e.nomeFertilizzante)||(this.tipiFertilizzante.push(this.selectedTipoFertilizzante),this.tipiFertilizzante.sort((i,n)=>i.name.localeCompare(n.name)),this.dt.totalRecords=this.fertilizzanti.length)}eliminaFertilizzante(e){this.fertilizzanti=this.fertilizzanti.filter(i=>i.nomeFertilizzante!=e.nomeFertilizzante),this.tipiFertilizzante.find(i=>i.name==e.nomeFertilizzante)||(this.tipiFertilizzante.push(this.tipiFertilizzanteCheck.find(i=>i.name==e.nomeFertilizzante)),this.tipiFertilizzante.sort((i,n)=>i.name.localeCompare(n.name))),this.selectedTipoFertilizzante=void 0,this.dt.totalRecords=this.fertilizzanti.length,this.misurazione.inputMisurazione.operazioniColturali.fertilizzanti=this.fertilizzanti,this.misurazione.dataOraUltimoAggiornamento=(new Date).toUTCString(),this.misurazioneService.salvaMisurazioneLocalStorage(this.misurazione),this.misurazioneService.updateMisurazione(this.misurazione.nomeMisurazione,this.misurazione)}chiudiDialogFertilizzante(){this.dialogFertilizzantiVisible=!1,this.fertilizzanti.forEach(e=>{let i=this.tipiFertilizzante.find(n=>n.name==e.nomeFertilizzante);i&&(this.tipiFertilizzante=this.tipiFertilizzante.filter(n=>n.name!==(null==i?void 0:i.name)))})}salvaFertilizzante(){if(this.selectedNumeroPassate&&this.selecteQuantitaKgEttaro&&this.selectedPercentualeAzoto){this.fertilizzanti.find(n=>n.nomeFertilizzante==this.selectedTipoFertilizzante.name)&&(this.fertilizzanti=this.fertilizzanti.filter(n=>n.nomeFertilizzante!==this.selectedTipoFertilizzante.name)),this.fertilizzante={},this.fertilizzante.numeroPassate=this.selectedNumeroPassate,this.fertilizzante.quantitaKgEttaro=this.selecteQuantitaKgEttaro,this.fertilizzante.percentualeAzoto=this.selectedPercentualeAzoto;let i=this.selectedTipoFertilizzante.operandiCalcoloWater.n1*this.selectedNumeroPassate+this.selectedTipoFertilizzante.operandiCalcoloWater.n2*this.selecteQuantitaKgEttaro;this.fertilizzante.co2Ettaro=(this.selectedTipoFertilizzante.operandiCalcoloCo2.n1*this.selectedNumeroPassate+this.selecteQuantitaKgEttaro*this.selectedTipoFertilizzante.operandiCalcoloCo2.n2+this.selectedTipoFertilizzante.operandiCalcoloCo2.n3*(this.selectedPercentualeAzoto*this.selecteQuantitaKgEttaro)/100*this.selectedTipoFertilizzante.operandiCalcoloCo2.n4).toFixed(3).toString(),this.fertilizzante.m3BlueWaterEttaro=i.toFixed(3).toString(),this.fertilizzante.nomeFertilizzante=this.selectedTipoFertilizzante.name,this.fertilizzanti.push(this.fertilizzante),this.tipiFertilizzante=this.tipiFertilizzante.filter(n=>n.name!=this.fertilizzante.nomeFertilizzante),this.dt.totalRecords=this.fertilizzanti.length,this.dialogFertilizzantiVisible=!1,this.misurazione.inputMisurazione.operazioniColturali.fertilizzanti=this.fertilizzanti,this.misurazione.dataOraUltimoAggiornamento=(new Date).toUTCString(),this.misurazioneService.salvaMisurazioneLocalStorage(this.misurazione),this.misurazioneService.updateMisurazione(this.misurazione.nomeMisurazione,this.misurazione)}}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(P.Hc))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-fertilizzanti"]],viewQuery:function(e,i){if(1&e&&t.Gf(Z,5),2&e){let n;t.iGM(n=t.CRH())&&(i.dt=n.first)}},decls:15,vars:14,consts:[[1,"container"],["id","card",1,"card"],["styleClass","p-mb-4"],[1,"title"],["pTemplate","left"],["scrollHeight","310px","dataKey","id","currentPageReportTemplate","Visualizzazione {first} su {last} di totale {totalRecords} voci",1,"table",3,"value","rows","paginator","virtualScroll","globalFilterFields","selection","rowHover","showCurrentPageReport","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],["header","Dettagli lavorazione","styleClass","p-fluid",3,"visible","modal","visibleChange","onHide"],["pTemplate","content"],["pTemplate","footer"],["pButton","","pRipple","","icon","pi pi-plus",1,"p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-arrow-left","routerLink","/pesticidi",1,"p-button-primary","p-mr-2"],["pButton","","pRipple","","icon","pi pi-arrow-right","routerLink","/emissioni-altre-attivit\xe0",1,"p-button-primary","p-mr-2",3,"disabled"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Ricerca...",1,"txt-search",3,"input"],["pSortableColumn","nomePesticidio",1,"t-header"],["field","name"],["pSortableColumn","numeroPassate",1,"t-header"],["field","price"],[1,"btn-edit"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2","btn-edit",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning","btn-edit",3,"click"],[1,"p-d-flex","p-ai-center","p-jc-between"],[1,"p-field"],["for","tipoLavorazioneList"],["id","tipoLavorazioneList","optionLabel","name",3,"disabled","options","ngModel","ngModelChange"],["for","numeroPassate"],[3,"ngModel","showButtons","min","required","ngModelChange"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-text",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"p-toolbar",2)(3,"h2",3),t._uU(4,"Fertilizzanti"),t.qZA(),t._UZ(5,"br"),t.YNc(6,T,9,1,"ng-template",4),t.qZA(),t.TgZ(7,"p-table",5,6),t.NdJ("selectionChange",function(o){return i.fertilizzantiSelezionati=o}),t.YNc(9,A,20,0,"ng-template",7),t.YNc(10,v,16,6,"ng-template",8),t.YNc(11,M,2,1,"ng-template",9),t.qZA()(),t.TgZ(12,"p-dialog",10),t.NdJ("visibleChange",function(o){return i.dialogFertilizzantiVisible=o})("onHide",function(){return i.chiudiDialogFertilizzante()}),t.YNc(13,x,21,15,"ng-template",11),t.YNc(14,E,2,0,"ng-template",12),t.qZA()()),2&e&&(t.xp6(7),t.Q6J("value",i.fertilizzanti)("rows",10)("paginator",!0)("virtualScroll",!1)("globalFilterFields",t.DdM(12,U))("selection",i.fertilizzantiSelezionati)("rowHover",!0)("showCurrentPageReport",!0),t.xp6(5),t.Akn(t.DdM(13,N)),t.Q6J("visible",i.dialogFertilizzantiVisible)("modal",!0))},dependencies:[s.JJ,s.Q7,s.On,d.YI,m.Hq,g.V,b.jx,h.Lt,C.Rn,_.o,c.iA,c.lQ,c.fz,f.o,p.rH],styles:["#card[_ngcontent-%COMP%]{margin-top:16%}.t-header[_ngcontent-%COMP%]{font-size:12px;font-family:Lucida Sans,Lucida Sans Regular,Lucida Grande,Lucida Sans Unicode,Geneva,Verdana,sans-serif;font-weight:700;margin-left:0}.container[_ngcontent-%COMP%]{background-image:url(/assets/images/wallpaper.jpg);background-repeat:no-repeat;height:100%;width:100%}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:.7rem}[_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th{padding:.2rem}[_nghost-%COMP%]     .p-button.p-button-icon-only.p-button-rounded{height:3rem;margin-top:3px}[_nghost-%COMP%]     .p-datatable .p-sortable-column .p-sortable-column-icon{margin-left:.3rem}[_nghost-%COMP%]     .p-toolbar{height:105px}[_nghost-%COMP%]     .table{width:60%}.title[_ngcontent-%COMP%]{margin-top:-1.5rem;padding-left:3rem;padding-bottom:0}.txt-search[_ngcontent-%COMP%]{width:190px}"]}),a})()}];let S=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[p.Bz.forChild(q),p.Bz]}),a})(),L=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[F.ez,s.u5,d.Pc,m.hJ,g.S,h.kW,C.L$,_.V,c.U$,f.j,S]}),a})()}}]);